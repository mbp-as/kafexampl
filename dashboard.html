<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <style>
        /* Ваши стили CSS */
        .event {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
        }
        .event h4 {
            margin-top: 0;
        }
        .event p {
            margin-bottom: 5px;
        }
        .btn {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            margin-right: 5px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h2>Future Events</h2>
    <div id="future-events"></div>

    <h2>Past Events</h2>
    <div id="past-events"></div>

    <script>
        // Функция для загрузки данных из JSON файла
        function loadEvents(file, containerId) {
            fetch(file)
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById(containerId);
                    container.innerHTML = ''; // Очищаем контейнер

                    data.forEach(item => {
                        const event = document.createElement('div');
                        event.classList.add('event');
                        event.innerHTML = `
                            <h4>${item.name}</h4>
                            <p>Date: ${item.date}</p>
                            <p>Description: ${item.description}</p>
                            <button class="btn" onclick="deleteEvent('${file}', '${item.name}')">Delete</button>
                        `;
                        container.appendChild(event);
                    });
                })
                .catch(error => {
                    console.error('Ошибка загрузки данных:', error);
                });
        }

        // Загрузить события из файлов
        document.addEventListener('DOMContentLoaded', function() {
            loadEvents('future.json', 'future-events');
            loadEvents('past.json', 'past-events');
        });

        // Функция для удаления события
        function deleteEvent(file, eventName) {
            console.log('Удаляем событие:', eventName);
            if (confirm('Вы уверены, что хотите удалить это событие?')) {
                console.log('Подтверждено удаление.');
                fetch(file)
                    .then(response => response.json())
                    .then(data => {
                        // Найти индекс события в массиве данных
                        const index = data.findIndex(item => item.name === eventName);
                        if (index !== -1) {
                            data.splice(index, 1); // Удалить событие из массива
                            
                            // Перезаписать файл с обновленными данными
                            fetch(file, {
                                method: 'PUT',
                                body: JSON.stringify(data),
                                headers: {
                                    'Content-Type': 'application/json'
                                }
                            })
                            .then(() => {
                                // После успешного обновления, перезагрузить данные на странице
                                loadEvents(file, file === 'future.json' ? 'future-events' : 'past-events');
                            })
                            .catch(error => {
                                console.error('Ошибка при обновлении данных:', error);
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Ошибка загрузки данных:', error);
                    });
            }
        }
    </script>
</body>
</html>
